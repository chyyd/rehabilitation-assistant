# 模板管理功能更新

## 📋 更新内容

### 1. 设置对话框 - 重命名标签
- **文件**: `electron-app/src/components/SettingsDialog.vue`
- **修改**: 将"模板管理"标签改名为"提取模板"
- **行号**: 237

```vue
<!-- 修改前 -->
<el-tab-pane label="模板管理" name="templates">

<!-- 修改后 -->
<el-tab-pane label="提取模板" name="templates">
```

### 2. 新增模板管理页面
- **新文件**: `electron-app/src/components/TemplateManager.vue`
- **功能**: 独立的模板管理界面

#### 主要功能
1. **模板列表展示**
   - 卡片式布局
   - 显示分类、内容、使用次数
   - 系统模板不可删除

2. **分类筛选**
   - 按4个大类15个二级分类筛选
   - 分组显示，emoji图标

3. **搜索功能**
   - 按模板名称和内容搜索
   - 实时过滤

4. **模板操作**
   - 复制：复制内容到剪贴板，自动增加使用次数
   - 编辑：修改模板名称和内容
   - 删除：确认后删除模板

5. **添加模板**
   - 对话框表单
   - 选择分类
   - 输入名称和内容

6. **自动刷新**
   - 监听`templates-updated`事件
   - 从"提取模板"页面保存后自动刷新

### 3. 主界面 - 添加入口
- **文件**: `electron-app/src/views/MainView.vue`
- **修改**: 导航栏添加"模板管理"按钮

#### 导航栏按钮顺序
1. 🔔 提醒（圆形按钮，带数量徽章）
2. ➕ 新患者（主要按钮）
3. 📄 模板管理（普通按钮） - **新增**
4. ⚙️ 设置（圆形按钮）

#### 模板管理对话框
```vue
<el-dialog
  v-model="showTemplateManager"
  title="模板管理"
  width="900px"
  :close-on-click-modal="false"
>
  <TemplateManager />
</el-dialog>
```

---

## 🎯 用户工作流程

### 工作流程1：提取新模板
1. 点击"设置"按钮
2. 选择"提取模板"标签
3. 上传文件
4. 点击"一键分析"
5. 查看AI提取结果
6. 点击"批量保存为模板"

### 工作流程2：管理已导入模板
1. 点击导航栏"模板管理"按钮
2. 打开模板管理对话框
3. 查看所有模板
4. 可以：
   - 筛选分类
   - 搜索关键词
   - 复制模板内容
   - 编辑模板
   - 删除模板
   - 添加新模板

### 工作流程3：使用模板
1. 在右侧"快速工具"栏
2. 选择分类
3. 点击模板卡片
4. 自动复制到剪贴板

---

## 📊 数据同步

### 自动刷新机制
使用事件总线（eventBus）实现组件间通信：

1. **SettingsDialog.vue**（提取模板页面）
   - 保存模板后触发：`eventBus.emit('templates-updated')`

2. **QuickTools.vue**（快速工具）
   - 监听事件：`eventBus.on('templates-updated', ...)`
   - 自动刷新当前分类的模板列表

3. **TemplateManager.vue**（模板管理）
   - 监听事件：`eventBus.on('templates-updated', ...)`
   - 自动刷新整个模板列表

---

## 🎨 界面特点

### 模板卡片设计
```
┌─────────────────────────────────────┐
│ [分类标签]          [复制][编辑][删除] │
│                                     │
│ 模板内容...                         │
│                                     │
│ 使用次数: 5                         │
└─────────────────────────────────────┘
```

### 分类筛选器
```
┌─────────────────────────────────┐
│ 🔍 搜索模板...        [分类筛选▼] │
└─────────────────────────────────┘
```

### 分类分组下拉
```
选择分类 ▼
├─ 📋 基础评估与诊断
│  ├─ 症状采集
│  ├─ 体格检查
│  ├─ 辅助检查
│  └─ 诊断结论
├─ 💉 治疗方案制定
│  ├─ 中医特色治疗
│  ├─ 中药治疗
│  ├─ 西药治疗
│  ├─ 康复治疗
│  └─ 护理操作
├─ 🔍 管理与监测
│  ├─ 医嘱与护理
│  ├─ 风险防控
│  ├─ 病情监测
│  └─ 并发症处理
└─ 💬 医患沟通与记录
   ├─ 医患沟通
   └─ 健康宣教
```

---

## 📁 修改的文件

1. ✅ `electron-app/src/components/SettingsDialog.vue`
   - 标签名修改

2. ✅ `electron-app/src/components/TemplateManager.vue`
   - 新建模板管理组件

3. ✅ `electron-app/src/views/MainView.vue`
   - 添加"模板管理"按钮
   - 添加模板管理对话框
   - 导入TemplateManager组件

---

## ✨ 功能对比

### 之前（单一"模板管理"标签）
- ❌ 提取和管理混在一起
- ❌ 功能不清晰
- ❌ 界面过于复杂

### 现在（分离的两大功能）
- ✅ **提取模板**：专注于从文件提取
  - 上传文件
  - AI分析
  - 批量保存

- ✅ **模板管理**：专注于已导入模板的管理
  - 查看所有模板
  - 搜索和筛选
  - 编辑和删除
  - 添加手动模板

---

## 🚀 使用建议

### 日常使用流程
1. **初期**：使用"提取模板"功能批量导入
2. **日常**：使用"快速模板"快速复制使用
3. **维护**：定期打开"模板管理"整理和优化模板

### 分类建议
- 按照实际使用频率组织模板
- 定期删除不常用的模板
- 将常用模板放在"快速工具"中

---

**更新日期**: 2026-01-31
**版本**: v1.2.0
